# Микросервисы на базе gRPC с использованием протокола SDI-12 

Этот проект содержит два микросервиса: SensorService и ClientService, которые используют gRPC для обмена данными.

## Инструкции по установке зависимостей, генерации gRPC кода, выполнению тестов и развертыванию контейнеров с микросервисами.

Развертывание и Запуск:

1. Установите Poetry, если его у вас нет:

   ```bash
   pip install poetry

    Для каждого микросервиса выполните следующие команды:

        Войдите в каталог микросервиса (например, sensor_service):

        bash

cd sensor_service

2. Установите зависимости с помощью Poetry:

    ```bash
    poetry install

3. Сгенерируйте gRPC код:

    ```bash
    poetry run python -m grpc_tools.protoc --python_out=. --grpc_python_out=. proto/sensor_service.proto

4. Выполните тесты:

    ```bash
    poetry run pytest -s tests/

5. Запустите микросервис:

    ```bash
    poetry run python sensor_service.py

6. В новой консоли, выполните тесты клиентского микросервиса:
   ```bash
    cd ../client_service
    poetry install
    poetry run pytest -s tests/

7. Запустите клиентский микросервис:
   ```bash
    poetry run python client_service.py

8. Для развертывания микросервисов в Docker, используйте команду:
   ```bash
    docker-compose up

Теперь можно обращаться к ClientService через порт 8080 и получать данные с помощью gRPC от SensorService.

# Описание протокола SDI-12 
SDI-12 (Serial Data Interface at 1200 baud) - это стандартный протокол передачи данных для мониторинга окружающей среды и систем сбора данных. Вот некоторые ключевые характеристики этого стандарта:

    Низкая скорость передачи данных: SDI-12 работает с низкой скоростью передачи данных - 1200 бит в секунду (baud). Это делает его подходящим для приложений, где потребление энергии и скорость передачи данных не являются критическими параметрами.

    Адресуемость: В один сбор данных можно подключить несколько датчиков, и каждому датчику присваивается уникальный адрес (обычно число от 0 до 9), чтобы можно было различать между ними.

    Двухпроводная связь: SDI-12 обычно использует двухпроводную систему связи, что упрощает подключение и снижает количество соединений.

    Полудуплексная связь: SDI-12 - это протокол полудуплексной связи, что означает, что данные могут передаваться в обоих направлениях, но не одновременно. Для передачи данных используется одна линия для двусторонней передачи данных и отдельная линия для подачи питания.

    Команды: Протокол использует простые команды для управления датчиками и выполнения задач, таких как сбор измерений или передача данных.

    Формат данных: Формат данных стандартизирован, что упрощает взаимодействие с различными датчиками от разных производителей.

    Низкое энергопотребление: SDI-12 разработан с учетом низкого энергопотребления, что делает его подходящим для систем, работающих от батарей и расположенных в отдаленных местах.

SDI-12 широко используется в области мониторинга окружающей среды из-за своей простоты и эффективности в потреблении энергии. Однако он может быть не подходящим для приложений, где требуется высокоскоростная передача данных или более сложная обработка данных, так как он в первую очередь предназначен для простого сбора данных от датчиков окружающей среды.

Формат передачи данных в протоколе SDI-12 очень простой и стандартизированный. В SDI-12 данные передаются в формате ASCII-символов. Вот основные элементы формата передачи данных в протоколе SDI-12:

    Команда (Command): Команда представляет собой одну или несколько букв, которые указывают датчику, какое действие нужно выполнить. Например, команда "M!" может указывать датчику начать измерение.

    Адрес (Address): Каждый датчик в сети SDI-12 имеет уникальный адрес, обычно число от 0 до 9. Этот адрес используется для адресации конкретного датчика в сети.

    Интервал (Data Interval): Интервал данных указывает датчику, как часто он должен выполнять измерения и передавать данные.

    Данные (Data): Результаты измерений или другие данные, собранные датчиком, передаются как ASCII-символы.

    Контрольные символы (Checksum): Чтобы обеспечить надежность передачи данных, SDI-12 может включать контрольные символы, такие как "!" в конце команды, чтобы указать конец строки данных.

Пример команды и ответа в формате SDI-12:

    Команда: 0M!
        0 - адрес датчика (в данном случае, адрес 0)
        M - команда для начала измерения
        ! - символ завершения команды

    Ответ: +012.3
        + - положительное число
        012.3 - значение измерения (например, температуры или влажности)

